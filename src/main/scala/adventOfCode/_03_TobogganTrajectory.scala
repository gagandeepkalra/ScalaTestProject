package adventOfCode

import scala.annotation.tailrec

object _03_TobogganTrajectory {

  def countTrees(grid: Vector[String], right: Int, down: Int): Int = {
    val rows = grid.length
    val cols = grid(0).length

    def isTree(r: Int, c: Int): Option[Boolean] = {
      if (r >= rows) None
      else {
        Some(grid(r)(c % cols) == '#')
      }
    }

    @tailrec
    def loop(r: Int, c: Int, acc: Int = 0): Int = {
      isTree(r, c) match {
        case Some(true)  => loop(r + down, c + right, acc + 1)
        case Some(false) => loop(r + down, c + right, acc)
        case None        => acc
      }
    }

    loop(0, 0)
  }

  def main(args: Array[String]): Unit = {
    val grid = Vector(
      ".........#..##.##..............",
      "#...#.#..#.....................",
      ".#...#..#...................#..",
      "........##..#...#..............",
      ".#.#.....#..#..##......#.......",
      "....#..#...#..##........#..##..",
      "...#....##........#.......#.#..",
      "....#................#...###..#",
      "...#...#.#..#....#.......####.#",
      ".....#...#..........#...#..#.#.",
      "....#..#............#.#.#.#..#.",
      "..#....#.###..#............#...",
      ".....#.............#.#.........",
      ".#.##............##.........#..",
      "...##...#..#....#.##..#.....#..",
      "..............#.#.........#.##.",
      "...........#.....##....##......",
      ".......#............#...#......",
      "............#.#....#....#..#..#",
      "....#................####......",
      "...#.........................##",
      "..........#........#.#.........",
      "....#.#....#...........#......#",
      "..#.#..##......##..##..#..#.#..",
      "...#.....##......#.#.#.........",
      ".........#.#....#...#.#.#......",
      ".......#.......###.#.......#...",
      "..#............##..#.......#...",
      "...#....#......#...#...#...#...",
      "......#..#.#.....##......#.....",
      "...........##...##...#....#.##.",
      "#.##..#.....##..#.#............",
      ".#.#.....##......#.##........#.",
      "..#...#...#...#..........#...##",
      "...##.........................#",
      ".....#......#.....##....#.....#",
      "..#........#...................",
      "#......#..#.#..#..#.#..#...#...",
      "...............#..........#....",
      ".....#...........#......#....#.",
      "........#..#...............#...",
      ".........#...#.......#.#..#...#",
      "..#..#......#.##..........#....",
      ".#...#....#.....#.............#",
      ".##.....#.........#......#..#..",
      "........#..##.......#......#...",
      ".......#.....###......#..#.....",
      ".......#.#.......#.............",
      "...#................##.#.......",
      "..##..#...#.#...#.#..#.#.#.##..",
      ".......#.#............#...#....",
      "#...#.....#......#..........##.",
      ".#.......#......#.......#.#.#..",
      ".#.##.#.#...........#..........",
      ".......#.....#....#.#.##......#",
      ".###..#...#.............##.....",
      "......#......#.................",
      "##...#.#...##...#.#.....#....#.",
      "#.............#....##...#....#.",
      "#.#...#....#........#.###..##..",
      "......#.........#......#.#.#.#.",
      "..#.#.#.....#........#..#...#..",
      "#.##....#.#......#...........#.",
      ".#.#.####.........#..#.##....##",
      "......##...............#......#",
      ".......#.........#........#.#..",
      "....#....#..#.##.........#..#..",
      ".#..........#.##....#.#..#.....",
      "#..#.#............#..#....#.#.#",
      "..................#..#.........",
      "##..##.#....#.................#",
      "..................#........#..#",
      ".....#.........#.......##......",
      ".....................#.#..#...#",
      ".....#.........#..........#.#..",
      "...#.#..#..#.#.#.......#.......",
      ".....#.....#.#.........#.....##",
      ".............##....#....##.#...",
      ".#......#........##..#...###...",
      "........#.......##.##.#......#.",
      "..#....................#.##..#.",
      "......#.......#..#....##.#.....",
      "...#....#.......##...#.......#.",
      ".#.#..#.#..........##..........",
      "....#.......##...........#.....",
      "###....#.......#..#...#.....##.",
      "...#......#.........#..#.#..#.#",
      "#.........#..##.#..............",
      ".#.....#..##.#..#..###.....##.#",
      "..........#..#....##.......#...",
      ".#..#.#...#...##.#..#.##.#.....",
      "#....#...#........#......##....",
      "..#.####....#.#........#....#..",
      "#......#............#.#........",
      "...#..#.......##...........#...",
      ".........#..#.#..#.###.#...#..#",
      "..#....##.......#.............#",
      "............#..#......#........",
      "........#......#..............#",
      "..#.#.#...........#............",
      "...........#......##.#.#.......",
      ".#..........#...........#..#...",
      ".....#...#..#.........##...#...",
      ".......#....##....#.#.........#",
      "..#.#......#.......#...##.#....",
      ".....#..........#........#.....",
      "#.......#.......#............#.",
      "..##.#.....#.##.#.#.#..#.......",
      "..#...#.......#.###............",
      ".#...#..#....#...#...#..#....##",
      ".....#.....#...................",
      ".......................#......#",
      "......#...##.........#...#..#..",
      ".....#..#.....#..............#.",
      ".#.##..#..#....................",
      "....#..#...#....#.............#",
      "..###..#...#......#.....#......",
      "..#......###....#.....#.....###",
      "...#.##..#...#.....#........#..",
      ".#.#...........##....#...#.##..",
      ".......#...##......#..#..#.....",
      "#.............#..#...##.#..#..#",
      "..........#......#.......#.....",
      "...............#.#.#....#...#..",
      "#.......#.#..#.....#........#..",
      ".#.#.#.......#..#.........##...",
      "......#.....#.#....#...........",
      "..#.....##.#........##.#......#",
      "...###...#..#.........#........",
      "....#...................#..#...",
      ".##........#...................",
      "....#..#...........#.#.........",
      ".....#.......#...#....#.#......",
      ".........#...#.......#.#...#...",
      ".......#.#..#....#....#.......#",
      "..#.............#..............",
      ".#...#..#.#.#..#............#..",
      "...#.##.##..#..#...........##..",
      "...........#...#..#.#........#.",
      "....#...#.....#...#.#....#...#.",
      ".......#.#...##..#.............",
      ".......................#....#..",
      "..#..#.....#...........#....#..",
      ".#..#...#.##........##....#....",
      "#.....##.#.#.......#.....#...#.",
      ".#....#.......................#",
      "#..##..###...#.........#.......",
      "..##...#...#..........#....#...",
      "......#..##......##.#.........#",
      "................#........#..#..",
      ".....#.#..#.....#.......#..#...",
      "..#..#.....#.......#..#..#...#.",
      ".#....#...#...#......##.....#..",
      "....#........#...#......##....#",
      "..#..........##......#......#..",
      "#.#.....#.....#.......#........",
      "...#...#......#....##.#..#...##",
      "...#....#...#.#...........##...",
      "#....##...#...#....#...........",
      "...#.#..#...#..............##..",
      "#..#..........##.#.#.....#.....",
      "..#...#.........#.#..........#.",
      "....#.....#..........#.........",
      "........................#......",
      ".#.....#.#...###...#....#......",
      "....##....#....#..#.##........#",
      "..#........#.........#.......#.",
      ".....#.#......#...#...#........",
      "........#..#.....#....###....#.",
      "...........#..#.#....#.#....##.",
      ".......#.....##.#............#.",
      "...............#........##.##..",
      ".............#...##......#...#.",
      "#...##.#.......#......###.....#",
      "..........#...#........#..#....",
      "....#....................#...#.",
      ".#......#...#.......#....#.#...",
      "....#.......................#..",
      "#...#...#...#.##....##.........",
      "..........#.#...##.#...#.......",
      "..#...............#....#..#...#",
      "#..#..#...#..#.........#...#...",
      ".....#..#..........#.##.#..##..",
      "........#......##.....#........",
      ".#....#.#.........#...#..#.#...",
      "....#..............##..........",
      "#...............#..............",
      "..###.........#....##.........#",
      ".........#.#....##........#...#",
      "....#.#..#......#...#..........",
      "...#.#.....#....#..#....#.#..#.",
      "............#..#.....#...##....",
      "...........#....#.#.#...#......",
      "#...............#....###.......",
      ".........#.....##.#..#..#......",
      "...#...##...###...............#",
      ".#......#.#.#.................#",
      ".........##..#............#....",
      "..#..#.....#.....#.#...........",
      ".#......##............#.#....#.",
      ".#.##..##.##..#.........#.....#",
      "...##.##......##.##......#.....",
      "##.....#.#...#...#...#..#......",
      "....................#......#...",
      ".....#.................#...###.",
      "...........#..#.........#.#....",
      "...#........#..#........#....#.",
      "#................#......###...#",
      ".............##.#.....#.#......",
      "...#...#.##..#........##.......",
      "#..#.##...#....#.#.............",
      ".#.........#.#..#...........#..",
      "....#...#.....#.#..........#...",
      ".#.#....###.......##.....#.##..",
      ".##....##......#......#.#....#.",
      "..#...#.#........#...#..##.....",
      "..............###..........##..",
      "#....#..##.....#.....#.....#...",
      "...#...#....................#..",
      ".#....#.#.....#.#..#..##.......",
      "#...##..###......#.............",
      "..........#.#....##.#........##",
      "..#..#.....#...#....#.#.#......",
      "#.....#........#..##.#.........",
      "....#.....#..........##......#.",
      "......#..#.....#........#.....#",
      ".....#..#....#...........#.##..",
      ".#....................#....#..#",
      "........#..#...........#.......",
      "#....#.#.......#........#.#..#.",
      "........#.....#...#............",
      "..#........#........#....#...#.",
      ".....##.......#..#..........#..",
      "......#.#......###...#....##..#",
      ".#..#.............#.#..........",
      "#.....##.#.#.#.#.#.....#.....#.",
      ".#..#.....#.......#.#.....#....",
      "###....##...#.#...#..#......###",
      ".#................#.....#.##...",
      "....##....#.#........###.#.#...",
      "#.#....#........#.....#.......#",
      "..........#..........#.##...#..",
      "....#....#..##......#..#.......",
      ".....#..........#.##...........",
      "##......#.#......#.##..........",
      "##..........##.......##........",
      "..#.....#....#.##..#..#..#.....",
      "......###...#...........#...###",
      "#..#.............##............",
      "...#.###.....#..#.........#.#..",
      "......#...............#...#.#..",
      ".....#...##.#...#.....#.#..#...",
      "..#..#.#....#.#................",
      "...............##.....#........",
      "......#.#.....#...#.........#..",
      "........#..#...#.#...#......#..",
      "#...........#.......#...##...#.",
      "........#.#...#..##..#.#...#...",
      "..#....#...#......#..........##",
      "..#..............##...##.#.....",
      "...#....#..#....##.........#.#.",
      ".#.#....#..........#.......#...",
      "...##....#.#....#....#.#...#...",
      "..............#..##........#..#",
      "..........#.#...##......#..#.#.",
      "#...##..#......................",
      ".......#........##.#.#.#.......",
      ".........##..#.#.......####....",
      "..#.............#..#........##.",
      "##..#..#...#....#.....#...#..#.",
      "..#.#...#.#.....#..............",
      "..#....#....#..##...#.#........",
      "##.....#..#...#................",
      "#....#.....................#...",
      "..............###.....#.#.#....",
      "..#......##.#....#.#...##......",
      "#...#.#......#...#.#......#....",
      "....#...................##.#...",
      ".........##......#.....#.####..",
      "##..#........#.....#......##..#",
      "...#..#...#...#.............#..",
      "#..#..#.#......###...#.........",
      ".......#.#..#........#....##..#",
      "............#..##.....#.#.#....",
      "#..#.....#.....#....##........#",
      "......#..........##............",
      ".....#...#...........#.........",
      "...........#....#...#....#.#...",
      "....#.........##.##.......#....",
      "......#....#...........#.##...#",
      ".##.#.#..##...#.....##.#...#...",
      ".......#.#....#...#...#....#...",
      ".#...##.#.#.....#..#....#......",
      ".#....###..#.......#......#...#",
      "..#.#.........#.........#.....#",
      ".......#.#.##..#.#.......##..#.",
      ".##............#.........#....#",
      ".#...##.###..#........##.#..#..",
      "..#........#.#.....##..##.#....",
      "...........#...........#.....#.",
      ".#...######..##...#.....#......",
      ".#.##.#.......#......#......#..",
      ".#.....#.....#........#........",
      "...#..#...#.##...#...........#.",
      ".......#.....#.......#.........",
      "............#...###...........#",
      "...#.......#.......##....#..#..",
      "##.......#....#....####........",
      ".......#.#......#..........#..#",
      "#.....##..#..#.....#....#...#..",
      "#............#........##.......",
      ".#.#...#.............#..##.....",
      ".#....#..#.#......#.##.......##",
      "...................##...##..###",
      "..#.....#...#................#.",
      "..#...#....#...#.#.#...#.....#.",
      ".....#............#....#...#..#",
      ".#.....#....#..#......#.#.....#",
      "............#.#.....####.##....",
      "....#......###....#...#....#...",
      "#.....#..#.....#..#...#.......#",
      "..#.#...#....#....##..#...##...",
      ".##..#..#..##....##...#........",
    )

    val product = 1L *
      countTrees(grid, 1, 1) *
      countTrees(grid, 3, 1) *
      countTrees(grid, 5, 1) *
      countTrees(grid, 7, 1) *
      countTrees(grid, 1, 2)

    println(product)
  }
}
